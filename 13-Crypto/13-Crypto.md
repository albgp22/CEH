# Substitution Ciphers
  - Rotation -> Brute force attack vulnerable
  - VigenÃ¨re

# Diffie-Hellman

$P,Q$ public keys, $a$ Alice's private key, $b$ Bob's private key

$x=G^a\mod P$, $y=G^b\mod P$

Exchange $x,y$

$k_a=y^a\mod P$, $k_b=x^b\mod P$, $k_a=k_b$

# Symmetric Key Cryptography

## DES (Data Encryption Standard)

Block cipher using 56-bit symmetric key. Long deprecated. Based on Lucifer cipher.
Block size is 64 bits (8 bits are used for parity).

Triple DES (3DES)there are three keys (totally 168 bits). Encrypt with key1, decrypt with key2 and encrypt again with key3. 3DES also deprecated.
3DES is not really a 168-bit key but three 56-bit separate keys.

## AES (Advanced Encryption Standard)

Based on Rijndael cipher. Different key lengths and block size of 128 bit. Keys of 128, 196 and 256 bits. 128-bit keys are no longer secure.

> A ciphersuite consists of multiple components: 1. Key exchange. 2. encryption cipher. 3. message authentication code.

Currently, the only possible way to attack AES is to use a side-channel attack. 

A side-channel attack is the ones to perform without extensive understanding of the inner workings of the algorithm. Taking advantage of things like CPU utilization, EM leaks or whatever. That means that AES is, at least to date, invulnerable.

# Asymmetric Key Cryptography

AKC is expensive ub terms of computing power. Also, everyone needs to have the key, which is impractical.
In SKC we still have the problem of key exchange.

Solution: hybrid ecosystem. The public key can be used to protect the symmetric key. This symmetric keys is referred to as the session key.
DH is not commonly used in this hybrid ecosystem.

Nonrepudiation: asymmetric keys can also be used to digitally sign messages. This demnostrates the onwer of a given message.

## RSA (Rivest-Shamir-Adleman)

Common key sizes are 1024, 2048 and 4096 bits.

## ECC (Elliptic Curve Cryptography)

It is assumed that identifying the discrete lograithm of a random elliptic curve is infeasible. Key size is much smaller -> reduces necessary computing power for encryption and decryption.

Idea: yo select a point in the curve $y^2=x^3-x+1$ (example) and find the discrete logarithm for this point.

# Certificate Authorities and Key Management

Keys can be stored in a data strcuture called certificate. Defined by X.509, which is part of a larger X.500 standard. Ideally we need a repository to store certificates.

## CA

A certificate authority is a repository of certificates. It issues certs to users. CA and related mechanism is called PKI (public key infrastructure). Sometimes the company that has one of these repos is also calle Certificate Authority.

The root certificate is the certificate that all other certificates in the CA are signed by.

The CA can revoke certificates. Revoked certificates are managed through the use of certificate revocation lists (CRLs). The Online Certificate Status Protocol (OSCP) can be used to verify a certificate with a CA.

## Self-Signed Certificates.

Create self-signed cert:

```
openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365
```

Show cert:

```
openssl x509 -in cert.pem -text
```

# Hashing

## MAC (Message Authentication Code)

A MAC is a fixed-length value that is generated by running the entire message through a cryptographic algorithm. The output is often referred to as a hash.

> Birthday paradox and the problem of hash collision.

Cryptographic hashes are commonly used for file integration systems.

### MD5 (Message Digest 5)

Starting to be deprecated. 128 bits. md5sum. 

### SHA-1 (Secure Hash Algorithm 1)

Was the replacement for MD5. 160 bits output.

### SHA-2

Different digest sizes: 224, 256, 384 and 512.

### Sha-3

supports arbitrary digest size.

# PGP and S/MIME

Pretty Good Privacy (PGP) does not use a CA. It uses a "web of trust". Keys are uploaded to a web server. People that knows the key uploader will sign to say that the key really belongs to the user it purports to belong to. PGP sometimes used for email encryption.

Secure/Multipurpose Internet Mail Extensions (S/MIME) is another protocol for sending encrypted email messages. It also uses X.509 certificates from CAs. These certificates my commonly be installed in an Windows Active Directory.

# Disk and File Encryption

Types of data: data in motion, data in use (in memory), *data at rest*.

Many hardware systems have something called the Trusted Platform Module (TPM). This is a cryptographic processor on a chip. Usually found in devices that are meant to run Windows.

FileVault (macOS) uses AES to encrypt volumes. BitLocker in Windows. dm-crypt in Linux (inside Linux kernel). 

In linux you need to add the Linux Unified Key Setup (LUKS) header to the drive. 

```
sudo cryptsetup luksFormat /dev/sfd1
```

